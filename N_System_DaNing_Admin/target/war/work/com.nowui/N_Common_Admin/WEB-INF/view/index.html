<!DOCTYPE html>
<html>
<head>
    <title>上海市闸北区大宁国际学校办公系统</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" >
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1">
	<link rel="stylesheet" type="text/css" href="/css/theme-triton-all_1.css" />
	<link rel="stylesheet" type="text/css" href="/css/theme-triton-all_2.css" />
	<link rel="stylesheet" type="text/css" href="/css/font-awesome-all.css" />
	<link rel="stylesheet" type="text/css" href="/css/font-pictos-all.css" />
	<link rel="stylesheet" type="text/css" href="/css/app.css" />
    <script src="/js/ext-all.js"></script>
    <script src="/js/theme-triton.js"></script>
    <script src="/js/model.js"></script>
    <script src="/js/app.js"></script>
    <script src="/js/component.js"></script>

    <style type="text/css">
		.x-window-header-title-default > .x-title-icon-wrap-default > .x-title-icon-default {
		    background-position: center center;
		    height: 2px;
		    width: 16px;
		}
    </style>
</head>
<body>
<script type="text/javascript">
	Ext.onReady(function() {
		Ext.tip.QuickTipManager.init();

		var system_index_north_north = Ext.create("N_Toolbar", {
	    	id: "system_index_north_north",
			region: "north",
			items: [{
				xtype: "label",
				text: "上海市闸北区大宁国际学校办公系统",
				style : "font-size : 20px; font-weight: bold; color : white;"
			}, "->" , {
				xtype: "button",
				iconCls: "x-fa fa-user",
				text: "<%if(! isEmpty(user)) {%>欢迎您:  ${user.name}<%if(! isEmpty(user.roleName)) {%>, ${user.roleName}<%}%><%if(! isEmpty(user.departmentName)) {%>, ${user.departmentName}<%}%><%}%>"
			}, {
				xtype: "button",
				iconCls: "x-fa fa-lock",
				text: "修改密码",
				handler: function() {
					showMessage("该功能即将开放!");
				}
			}, {
				xtype: "button",
				iconCls: "x-fa fa-power-off",
				text: "注销",
				handler: function() {
					window.location.href = "/logout";
				}
			}]
	    });

	    var system_index_north_center_office = Ext.create("N_Container", {
	    	id: "system_index_north_center_office",
	    	title: "移动办公",
	    	iconCls: "pictos pictos-browser"
	    });

	    var system_index_north_center_mine = Ext.create("N_Container", {
	    	id: "system_index_north_center_mine",
	    	title: "我的申请",
	    	iconCls: "x-fa fa-user"
	    });

	    var system_index_north_center_news = Ext.create("N_Container", {
	    	id: "system_index_north_center_news",
	    	title: "信息发布",
	    	iconCls: "pictos pictos-news"
	    });

	    var system_index_north_center_school = Ext.create("N_Container", {
	    	id: "system_index_north_center_school",
	    	title: "学校设置",
	    	iconCls: "pictos pictos-team"
	    });

	    var system_index_north_center_setting = Ext.create("N_Container", {
	    	id: "system_index_north_center_setting",
	    	title: "系统设置",
	    	iconCls: "pictos pictos-settings"
	    });

	    var system_index_north_center = Ext.create("N_Tab", {
	    	id: "system_index_north_center",
	        region: "center",
	        margin: "0 0 0 0",
        	plain: false,
        	style: "background-color: #ececec;",
        	items: [
        		system_index_north_center_office,
        		system_index_north_center_mine,
        		system_index_north_center_news,
        		system_index_north_center_school,
        		system_index_north_center_setting
        	],
        	listeners: {
        		tabchange: function(tabPanel, newCard, oldCard, eOpts) {
					if(newCard.id == "system_index_north_center_office") {
						system_index_function_store_office_load();
					} else if(newCard.id == "system_index_north_center_mine") {
						system_index_function_store_mine_load();
					} else if(newCard.id == "system_index_north_center_news") {
						system_index_function_store_news_load();
					} else if(newCard.id == "system_index_north_center_school") {
						system_index_function_store_school_load();
					} else if(newCard.id == "system_index_north_center_setting") {
						system_index_function_store_setting_load();
					} else {
						system_index_west.store.loadRawData([])
					}
        		}
        	}
	    });

	    var system_index_north = Ext.create("N_Container", {
	    	id: "system_index_north",
			region: "north",
	    	layout: "border",
	    	height: 88 + 5,
	    	items: [
	    		system_index_north_north,
	    		system_index_north_center
	    	]
	     });

	     var system_index_function_store_office_load = function() {
	     	system_index_west_store.loadRawData([{
	        	id: 1,
				text: "待办事项",
				value: "task_index",
				url: "/task/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 2,
				text: "通知公告",
				value: "notice_category_notice_indexmine",
				url: "/notice/mine/index.html",
				params: {
					value: "category_notice"
				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 3,
				text: "会议信息",
				value: "notice_category_meeting_indexmine",
				url: "/notice/mine/index.html",
				params: {
					value: "category_meeting"
				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 4,
				text: "代码生成",
				value: "code_index",
				url: "/code/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			}]);
	     }

	     var system_index_function_store_mine_load = function() {
	     	system_index_west_store.loadRawData([{
	        	id: 1,
				text: "请假申请单",
				value: "leave_index",
				url: "/leave/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 2,
				text: "采购申请单",
				value: "purchase_index",
				url: "/purchase/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 3,
				text: "维修申请单",
				value: "maintenance_index",
				url: "/maintenance/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			}]);
	     }

	     var system_index_function_store_news_load = function() {
	     	system_index_west_store.loadRawData([{
	        	id: 1,
				text: "发布通知公告",
				value: "notice_category_notice_index",
				url: "/notice/index.html",
				params: {
					value: "category_notice"
				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 2,
				text: "发布会议信息",
				value: "notice_category_meeting_index",
				url: "/notice/index.html",
				params: {
					value: "category_meeting"
				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 3,
				text: "发布校园资讯",
				value: "article_index",
				url: "/article/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 4,
				text: "发布学校简介",
				value: "page_index",
				url: "/page/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			}]);
	     }

	     var system_index_function_store_school_load = function() {
	     	system_index_west_store.loadRawData([{
	        	id: 1,
				text: "老师管理",
				value: "teacher_index",
				url: "/teacher/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 2,
				text: "学生管理",
				value: "",
				url: "",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 3,
				text: "部门管理",
				value: "category_indextreegirl",
				url: "/category/indextreegirl.html",
				params: {
					value: "category_department"
				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 4,
				text: "年级管理",
				value: "grade_index",
				url: "/grade/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 5,
				text: "班级管理",
				value: "class_index",
				url: "/class/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			}]);
	     }

	     var system_index_function_store_setting_load = function() {
	     	system_index_west_store.loadRawData([{
	        	id: 1,
				text: "分类管理",
				value: "category_index",
				url: "/category/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 2,
				text: "菜单管理",
				value: "",
				url: "",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 3,
				text: "角色管理",
				value: "",
				url: "",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 4,
				text: "流程管理",
				value: "workflow_index",
				url: "/workflow/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			},  {
	        	id: 5,
				text: "资源管理",
				value: "resource_index",
				url: "/resource/index.html",
				params: {

				},
				iconCls: 'x-fa fa-list-ul',
				leaf: true
			}]);
	     }

	     var system_index_west_store = Ext.create("Ext.data.TreeStore", {
	     	id: "system_index_west_store",
		    root: {
		        expanded: true
		    }
		});

		system_index_function_store_office_load();

	    var system_index_west = Ext.create("N_Tree", {
	    	id: "system_index_west",
	        region: "west",
	        margin: "5 5 5 5",
        	width: 225,
        	store: system_index_west_store,
        	listeners: {
        		itemclick: function(view, record, item, index, e) {
					if(record.isLeaf()) {
						if(isNullOrEmpty(record.raw.url)) {
						 	showMessage("该功能即将开放!");
						 	return;
						}

						var itemId =  "tab_" + record.raw.value;

						if(Ext.getCmp(itemId)) {
							system_index_center.setActiveTab(itemId);
						} else {
							var tabPanel = system_index_center.add({
								id: "tab_" + record.raw.value,
	    						title: record.raw.text,
	    					   	iconCls: record.raw.iconCls,
	    					   	closable: true,
	    					   	layout: "fit",
	    						listeners: {
	    							beforeclose: function() {
										system_index_center.remove(Ext.getCmp(id));
	    							}
	    						}
	    					});

	    					system_index_center.setActiveTab(tabPanel);

	    					Ext.apply(record.raw.params, {
								titleName: record.raw.text,
								iconCls: record.raw.iconCls
							});

	    					loadScript({
	    						id: id,
	    						url: record.raw.url,
	    						iconCls: record.raw.iconCls,
	    						params: record.raw.params
	    					});
						}
					}
        		}
        	}
	    });

	    var system_index_center_home = Ext.create("N_Container", {
	    	id: "system_index_center_home",
	    	title: "我的桌面",
	    	iconCls: "x-fa fa-home",
			padding: 5
	    });

		var system_index_center = Ext.create("N_Tab", {
	    	id: "system_index_center",
	        region: "center",
	        margin: "-3 5 5 0",
			plain: true,
        	items: [
        		system_index_center_home
        	]
	    });

		var system_index_viewport = Ext.create("N_Viewport", {
	    	id: "system_index_viewport",
	    	items: [
	    		system_index_north,
	    		system_index_west,
	    		system_index_center
	    	]
	    });
	});
</script>
</body>
</html>
